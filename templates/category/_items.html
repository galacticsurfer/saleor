{% load i18n %}
{% load staticfiles %}
{% load price_range from price_ranges %}
{% load product_first_image from product_images %}
{% load product_availability_schema from jsonld %}

{% for product, availability in products %}
    <div class="col-6 col-lg-3 product-list">
        <script type="application/ld+json">
          {% autoescape off %}{% product_availability_schema product %}{% endautoescape %}
        </script>
        <a href="{{ product.get_absolute_url }}">
            <div class="text-center">
                <div>
                    <img class="img-responsive" src="{% product_first_image product method="crop" size="400x400" %}" alt="">
                    <span class="product-list-item-name" title="{{ product }}">{{ product }}</span>
                </div>

                <div class="panel-footer">
                    {% if availability.available %}
                        <font style="font-weight: bold;color: black;">{% price_range availability.price_range %}</font> &nbsp;
                        {% if availability.discount_percentage %}
                            <strike><font style="font-size:0.80rem">{% price_range availability.price_range_undiscounted %}</font></strike> &nbsp;
                            <font style="font-size:0.70rem;font-weight: bold;color: green;">{{ availability.discount_percentage }} % off</font>
                        {% endif %}
                    {% else %}
                        &nbsp;
                    {% endif %}
                </div>
            </div>
        </a>
    </div>
{% endfor %}
